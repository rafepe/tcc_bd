{% extends "base.html" %}

{% block corpo %}

<div class="container mt-4">

    <!-- Navegação de semestre -->
    <div class="d-flex align-items-center justify-content-between mb-4">
        <div class="d-flex align-items-center">

            <!-- Botão Semestre Anterior -->
            <form method="get" class="me-2">
                {% if semestre == 1 %}
                    <input type="hidden" name="ano" value="{{ ano|add:"-1" }}">
                    <input type="hidden" name="semestre" value="2">
                {% else %}
                    <input type="hidden" name="ano" value="{{ ano }}">
                    <input type="hidden" name="semestre" value="1">
                {% endif %}
                <button type="submit" class="btn btn-outline-secondary">
                    <i class="fas fa-chevron-left"></i> Anterior
                </button>
            </form>

            <!-- Texto do semestre -->
            <div class="mx-3 text-center">
                <h4 class="mb-0 text-primary">{{ semestre }}º Semestre de {{ ano }}</h4>
                <small class="text-muted">
                    {% if semestre == 1 %}
                        Janeiro - Junho
                    {% else %}
                        Julho - Dezembro
                    {% endif %}
                </small>
            </div>

            <!-- Botão Semestre Seguinte -->
            <form method="get" class="ms-2">
                {% if semestre == 2 %}
                    <input type="hidden" name="ano" value="{{ ano|add:"1" }}">
                    <input type="hidden" name="semestre" value="1">
                {% else %}
                    <input type="hidden" name="ano" value="{{ ano }}">
                    <input type="hidden" name="semestre" value="2">
                {% endif %}
                <button type="submit" class="btn btn-outline-secondary">
                    Próximo <i class="fas fa-chevron-right"></i>
                </button>
            </form>

        </div>

        <!-- Botão Atualizar -->
        <button type="button" class="btn btn-outline-info" onclick="location.reload()">
            <i class="fas fa-sync-alt"></i> Atualizar
        </button>
    </div>

    <hr>

    <!-- Área de ZIP -->
    <div class="mt-4">

        {% if zip_exists %}

            <div class="alert alert-success">
                <i class="fas fa-check-circle"></i>
                Arquivo ZIP disponível para este semestre.
            </div>

<p class="text-muted mb-1">
    Arquivo: <strong>comprovantes_{{ ano }}_{{ semestre }}.zip</strong>
</p>

{% if zip_date %}
<p class="text-muted">
    Gerado em: <strong>{{ zip_date|date:"d/m/Y H:i" }}</strong>
</p>
{% endif %}


            <a href="{{ zip_url }}" class="btn btn-primary me-2" download>
                <i class="fas fa-download"></i> Baixar ZIP
            </a>

            <a href="?ano={{ ano }}&semestre={{ semestre }}&gerar=1"
               class="btn btn-warning">
                <i class="fas fa-redo"></i> Regerar ZIP
            </a>

        {% else %}

            <div class="alert alert-warning">
                <i class="fas fa-exclamation-circle"></i>
                Nenhum ZIP encontrado para este semestre.
            </div>

            <a href="?ano={{ ano }}&semestre={{ semestre }}&gerar=1"
               class="btn btn-success">
                <i class="fas fa-file-archive"></i> Gerar ZIP
            </a>

        {% endif %}

    </div>

</div>

{% endblock %}
